!function(){"use strict";var o=angular.module("LoyaltyCardApp",["ngRoute","ui.router","io-barcode"]);o.config(function(o,r,n){r.html5Mode(!0),o.when("/",{templateUrl:"pages/cards.html",controller:"cardController"}).when("/create",{templateUrl:"pages/createCard.html",controller:"createCardController"}).when("/view/:id",{templateUrl:"pages/viewCard.html",controller:"viewCardController"}).otherwise({redirectTo:"/"})})}(),function(){"use strict";var o=angular.module("LoyaltyCardApp");o.controller("cardController",["$rootScope","$scope","$window","$location","indexedDbFactory",function(o,r,n,e,t){function a(){t.openDb().then(function(){i=!0,c()},function(o){console.log("error.",o)})}function c(){i?t.getAllCards().then(function(o){r.cardList=o,r.$apply()},function(o){console.log("error.",o)}):a()}function l(o){e.path("/view/"+o._id)}o.title="Loyalty Cards - View Cards";var i=!1;r.cardList=[],r.showCard=l,r.refreshCards=c,r.loadData=a}]),o.controller("createCardController",["$rootScope","$scope","$window","indexedDbFactory",function(o,r,n,e){o.title="Loyalty Cards - Create Card";var t=!1;e.openDb().then(function(){t=!0},function(o){console.log("error.",o)}),r.addCard=function(){var o={Name:r.Name,Description:r.Description,Barcode:r.Barcode};e.addCard(o).then(function(){n.location.href="/"},function(o){})}}]),o.controller("viewCardController",["$rootScope","$scope","$window","$routeParams","indexedDbFactory",function(o,r,n,e,t){function a(){var o=e.id;c?t.getCard(o).then(function(o){r.card=o,r.$apply()},function(o){r.error="There was an error loading the selected card",console.log("error.",o),r.$apply()}):t.openDb().then(function(){c=!0,a()},function(o){console.log("error.",o)})}o.title="Loyalty Cards - Card Details";var c=!1;r.card=null,a()}])}(),function(){"use strict";function o(){function o(){var o=new Promise(function(o,r){o()});return o}function r(o){var r=new Promise(function(r,n){a.post(o).then(function(o){r()})["catch"](function(o){console.log(o),n("Error Inserting into db",this.error)})});return r}function n(){console.log("Get all cards");var o=new Promise(function(o,r){a.allDocs({include_docs:!0,attachments:!0}).then(function(r){var n=[];r.rows.forEach(function(o){n.push(o.doc)}),o(n)})["catch"](function(o){console.log(o),r("Error opening db:",e.target.errorCode)})});return o}function t(o){var r=new Promise(function(r,n){a.get(o).then(function(o){r(o)})["catch"](function(r){console.log(r),n("Error getting data for",o)})});return r}var a=new PouchDB("offlineLoyaltyCards");return{openDb:o,getCard:t,getAllCards:n,addCard:r}}var r=angular.module("LoyaltyCardApp");r.factory("indexedDbFactory",[o])}();