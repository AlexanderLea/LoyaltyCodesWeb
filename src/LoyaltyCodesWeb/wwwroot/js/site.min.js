!function(){"use strict";var r=angular.module("LoyaltyCardApp",[]);r.config(function(r,e){r.when("/",{templateUrl:"~/Views/Components/cards.html",controller:"cardController"}),e.html5Mode(!0)})}(),function(){"use strict";function r(r,e){function o(){n&&e.getAllCards().then(function(e){r.cardList=e},function(r){console.log("error.",r)})}var n=!1;r.cardList=[],e.openDb().then(function(){n=!0,o()},function(r){console.log("error.",r)})}var e="cardController";angular.module("LoyaltyCardApp").controller(e,["$scope","indexedDbFactory",r])}(),function(){"use strict";function r(){function r(){var r=new Promise(function(r,e){var o=indexedDB.open(c,a);o.onsuccess=function(e){s=this.result,console.log("Db open"),r()},o.onerror=function(r){console.error("openDb:",r.target.errorCode),e("Error opening db:",r.target.errorCode)},o.onupgradeneeded=function(r){console.log("openDb.onupgradeneeded");var e=r.currentTarget.result.createObjectStore(i,{keyPath:"Id",autoIncrement:!0});e.createIndex("Name","Name",{unique:!1}),e.createIndex("Description","Description",{unique:!1}),e.createIndex("Barcode","Barcode",{unique:!1})}});return r}function e(r,e){var o=s.transaction(r,e);return o.objectStore(r)}function o(r){var o=e(i,"readwrite"),n=new Promise(function(e,n){var t=o.add(r);t.onsuccess=function(r){console.log("Insertion in DB successful"),e()},t.onerror=function(){console.error("Error Inserting into db",this.error),n("Error Inserting into db",this.error)}});return n}function n(){console.log("Get all cards");var r=e(i,"readonly"),o=new Promise(function(e,o){var n=r.openCursor(),t=[];n.onsuccess=function(o){var c=o.target.result;c?(n=r.get(c.key),n.onsuccess=function(r){var e=r.target.result,o={Id:e.id,Name:e.Name,Description:e.Description,Barcode:e.Barcode};t.push(o)},c["continue"]()):(console.log("No more entries. cardList:",t),e(t))},n.onerror=function(r){console.error("openDb:",r.target.errorCode),o("Error opening db:",r.target.errorCode)}});return o}function t(r){var o=e(i,"readonly"),n=new Promise(function(e,n){var t=o.get(r);t.onsuccess=function(r){e(t.result)},t.onerror=function(e){console.error("Error getting data for",r),n("Error getting data for",r)}});return n}const c="LoyaltyCodesDb",a=2,i="Cards";var s;return{openDb:r,getCard:t,getAllCards:n,addCard:o}}angular.module("LoyaltyCardApp").factory("indexedDbFactory",[r])}();