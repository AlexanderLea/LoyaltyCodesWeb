!function(){"use strict";function e(e,r){e.cardList=[],r.openDb().then(function(){r.getAllCards().then(function(r){e.people=r}).error(function(e){console.log("error.",e)})})}var r="cardController";angular.module("LoyaltyCardApp").controller(r,["$scope","indexedDbFactory",e])}(),app.controller("CardController",function(e,r){function o(){r.openDb().then(function(){n()})}e.cardList=null;var n=function(){r.getAllCards().then(function(r){e.cardList=r},function(e){return $window.alert(e),null})};o()}),function(){"use strict";angular.module("LoyaltyCardApp",[])}(),function(){"use strict";function e(){function e(){var e=new Promise(function(e,r){console.log("openDb ...");var o=indexedDB.open(t,c);o.onsuccess=function(r){u=this.result,console.log("openDb DONE"),e()},o.onerror=function(e){console.error("openDb:",e.target.errorCode),r("Error opening db:",e.target.errorCode)},o.onupgradeneeded=function(e){console.log("openDb.onupgradeneeded");var r=e.currentTarget.result.createObjectStore(a,{keyPath:"Id",autoIncrement:!0});r.createIndex("Name","Name",{unique:!1}),r.createIndex("Description","Description",{unique:!1}),r.createIndex("Barcode","Barcode",{unique:!1})}});return e}function r(e,r){var o=u.transaction(e,r);return o.objectStore(e)}function o(){console.log("Get all cards");var e=r(a,"readonly"),o=new Promise(function(r,o){var n=e.openCursor();n.onsuccess=function(o){var t=[],c=o.target.result;c?(console.log("getAllCards cursor:",c),n=e.get(c.key),n.onsuccess=function(e){var r=e.target.result,o={Id:r.Id,Name:r.Name,Description:r.Description,Barcode:r.Barcode};t.push(o)},c["continue"]()):(console.log("No more entries"),r(t))},n.onerror=function(e){console.error("openDb:",evt.target.errorCode),o("Error opening db:",evt.target.errorCode)}});return o}function n(e){var o=r(a,"readonly"),n=new Promise(function(r,n){var t=o.get(e);t.onsuccess=function(e){r(t.result)},t.onerror=function(r){console.error("Error getting data for",e),n("Error getting data for",e)}});return n}const t="LoyaltyCodesDb",c=2,a="Cards";var u;return{openDb:e,getCard:n,getAllCards:o}}angular.module("LoyaltyCardApp").factory("indexedDbFactory",[e])}();